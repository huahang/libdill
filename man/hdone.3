.\" Automatically generated by Pandoc 1.19.2.1
.\"
.TH "HDONE" "3" "" "libdill" "libdill Library Functions"
.hy
.SH NAME
.PP
hdone \- announce end of input to a handle
.SH SYNOPSIS
.IP
.nf
\f[C]
#include\ <libdill.h>

int\ hdone(
\ \ \ \ int\ h,
\ \ \ \ int64_t\ deadline);
\f[]
.fi
.SH DESCRIPTION
.PP
This function is used to inform the handle that there will be no more
input.
This gives it time to finish it\[aq]s work and possibly inform the user
when it is safe to close the handle.
.PP
For example, in case of TCP protocol handle, hdone would send out a FIN
packet.
However, it does not wait until it is acknowledged by the peer.
.PP
After hdone is called on a handle, any attempts to send more data to the
handle will result in EPIPE error.
.PP
Handle implementation may also decide to prevent any further receiving
of data and return EPIPE error instead.
.PP
\f[B]h\f[]: The handle.
.PP
\f[B]deadline\f[]: A point in time when the operation should time out,
in milliseconds.
Use the \f[B]now\f[] function to get your current point in time.
0 means immediate timeout, i.e., perform the operation if possible or
return without blocking if not.
\-1 means no deadline, i.e., the call will block forever if the
operation cannot be performed.
.SH RETURN VALUE
.PP
In case of success the function returns 0.
In case of error it returns \-1 and sets \f[B]errno\f[] to one of the
values below.
.SH ERRORS
.IP \[bu] 2
\f[B]EBADF\f[]: Invalid handle.
.IP \[bu] 2
\f[B]ECANCELED\f[]: Current coroutine was canceled.
.IP \[bu] 2
\f[B]ENOTSUP\f[]: The handle does not support this operation.
.IP \[bu] 2
\f[B]EPIPE\f[]: Pipe broken.
\f[B]hdone\f[] was already called either on this or the other side of
the connection.
.IP \[bu] 2
\f[B]ETIMEDOUT\f[]: Deadline was reached.
.SH EXAMPLE
.IP
.nf
\f[C]
http_sendrequest(s,\ "GET",\ "/"\ \-1);
http_sendfield(s,\ "Host",\ "www.example.org",\ \-1);
hdone(s,\ \-1);
char\ reason[256];
int\ status\ =\ http_recvstatus(s,\ reason,\ sizeof(reason),\ \-1);
\f[]
.fi
.SH SEE ALSO
.PP
\f[B]hclose\f[](3) \f[B]hmake\f[](3) \f[B]hown\f[](3) \f[B]hquery\f[](3)
\f[B]now\f[](3)
